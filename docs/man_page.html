<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="ja">
<head>
<link rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="css/style2.css" type="text/css">
<meta name="keywords" content="keyboard, layout, typing, effort, qwerty, dvorak, colemak, arensito, capewell, best layout, worst layout, custom layout, simulated annealing, monte carlo, simulation">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Carpalx - keyboard layout optimizer</title>

<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open+Sans:400,700,800|PT+Serif:400,400italic,700|Inconsolata:400,700">

</head>

<body>

<div id="body">

<div id="page">

<div id="masthead">
<a href="index.html"><img src="images/carpalx-logo-v3-crop.png" alt="carpalx - keyboard layout optimizer - save your carpals"></a>
</div>


<div id="leftpane">

<div id="slogan">



<p title="Carpalx optimizes keyboard layouts to create ones that require less effort and significantly reduced carpal strain!">Carpalx はキーボード配列を最適化することで労力を減らし、手の負担を激減させる配列を作るプロジェクトです！

<p><a href="full_optimization.html"><img src="images/carpalx-ourbest.png"></a>
<p><a href="worst_layout.html"><img src="images/carpalx-ourworst.png"></a>

<p title="Download keyboard layouts, or run the code yourself to explore new layouts."><img src="images/download.png" style="float:left; padding: 0 0.25em 0 0;"><a href="download.html">完成した配列をダウンロード</a>してもいいし、<a href="requirements.html">自分でこのコードを使って</a>新配列の探求へ挑むのもオツでしょう。

<p title="X11 layouts are available! Patches to include Carpalx layouts in xkeyboard-config and kbd have been submitted by Perry Thompson. Meanwhile, many thanks to Sven Hallberg for providing X11 configuration for Carpalx layouts. Richard Gomes contributed an archive of these files for KDE/Gnome users."><img src="images/x.png" style="float:left; padding: 0 0.25em 0 0;"><b>X11 用定義、あります！</b> Perry Thompson 氏が <a href="https://www.freedesktop.org/wiki/Software/XKeyboardConfig/">xkeyboard-config</a> と <a href="http://kbd-project.org/">kbd</a> に Carpalx の配列を含めるパッチを送ってくれました。また、<a href="http://www.khjk.org/log/2011/jan/carpalx.html">Carpalx の配列の X11 設定</a>を提供してくれた Sven Hallberg 氏に感謝。Richard Gomes 氏には KDE/Gnome ユーザ向けの<a href="http://mkweb.bcgsc.ca/carpalx/distribution/carpalx-x11.zip">アーカイブ</a>を提供頂きました。

<p title="Love your coworkers? Switch them to QWKRFY layout or a fully optimized QGMLWY layout."><img src="images/happy.png" style="float:left; padding: 0 0.25em 0 0;">好きな子には <a href="partial_optimization.html">QWKRFY 配列</a>か、ガチに最適化された <a href="full_optimization.html">QGMLWY 配列</a>を勧めちゃおう。

<p title="Hate your coworkers? Switch them to TNWMLC layout. It's the only keyboard layout that has its own fashion line."><img src="images/sad.png" style="float:left; padding: 0 0.25em 0 0;">逆にムカつく奴にゃ <a href="worst_layout.html">TNWMLC 配列</a>、これだね。<a href="http://fashionnotebook.wordpress.com/2011/01/04/julia-valle-tnwmlc/">ファッションになってる</a>唯一の配列だし。

<p title="Have ideas? Tell me.">なんかアイデアあったら<a href="mailto:martin.krzywinski@gmail.com">教えてくれよな</a>。<br><span style="color:green;font-size:90%">≪訳注：メールアドレスは原文著者のもの。連絡するなら英語でね。≫</span>

</div>

<div id="menu">


<h1>carpalx</h1>
<a href="index.html" title="home">ホーム</a>
<a href="about.html" title="about">概略</a>
<a href="typing_effort.html" title="typing effort">打鍵負担モデル</a>
<a href="model_parameters.html" title="model parameters">モデルのパラメータ</a>
<a href="keyboard_evaluation.html" title="keyboard evaluation">配列の評価</a>
<a href="keyboard_layouts.html" title="keyboard layouts">実配列のデータ</a>
<h1 title="case studies">実例</h1>
<a href="qwerty.html">QWERTY</a>
<a href="dvorak.html">Dvorak</a>
<a href="colemak.html">Colemak</a>
<a href="popular_alternatives.html" title="Popular alternatives">その他</a>
<h1 title="optimization">最適化</h1>
<a href="partial_optimization.html" title="Partial optimization">部分最適化</a>
<a href="full_optimization.html" title="Full optimization">完全最適化</a>
<a href="worst_layout.html" title="Worst Layout">最悪の配列</a>
<a href="component_optimization.html" title="Component optimization">要素別最適化</a>
<a href="improving_colemak.html" title="Improving colemak">Colemak を超えていけ</a>
<a href="de_correspondent.html" title="De Correspondent">オランダ語に挑む</a>
<h1 title="tutorials">チュートリアル</h1>
<a href="simulated_annealing.html" title="simulated annealing">焼きなまし法 (SA)</a>
<a href="carpalx_installation.html" title="carpalx installation">Carpalx のインストール</a>
<a href="keyboard_statistics.html" title="keyboard statistics">配列の統計方法</a>
<a href="word_statistics.html" title="word statistics">ワードの統計方法</a>
<a href="basic_optimization.html" title="basic optimization">基本的な最適化</a>
<a href="concurrent_optimization.html" title="concurrent optimization">並行処理</a>
<a href="keyboard_images.html" title="keyboard images">配列画像の出力</a>
<a href="interpreting_optimization.html" title="interpreting optimization">結果の解釈</a>
<h1 title="documentation">ドキュメント</h1>
<a href="readme.html" title="README">README</a>
<a href="changes.html" title="CHANGES">変更履歴</a>
<a class=current href="man_page.html" title="man page">man page</a>
<h1 title="download">ダウンロード</h1>
<a href="requirements.html" title="requirements">動作環境</a>
<a href="download.html" title="download">ダウンロード</a>
<h1 title="author">著者について</h1>
<a href="contact.html" title="contact">連絡先</a>
<a href="other_projects.html" title="other projects">他プロジェクト</a>
<a href="https://github.com/stak/carpalx-ja/#carpalx-ja" style="color:green;">日本語訳について</a>



</div>


<div id="footer" title="Carpalx is licensed under GPL. It is free, freely distributable and yours to modify under the auspices of the GPL license.">Carpalx は GPL のもとにライセンスされています。GPL に従う限りにおいて、無料で使用でき、自由に改変・再配布することができます。</div>


</div>
</div>

<div id="rightpane">




<div class=update>
<p title="16/aug/16 &mdash; Ergonomic Keyboard Layout Designed for the Filipino Language at AHFE2016 derives layout for Filipino language using Carpalx">2016/08/16 &mdash; Carpalx で作られた配列をもとにした<a href="http://link.springer.com/chapter/10.1007/978-3-319-41694-6_41">フィリピン語用のエルゴノミクスキーボード配列</a>が、国際学会 <a href="http://www.ahfe2016.org/program1.html">AHFE2016</a> で発表されました。
<p title="18/apr/16 &mdash; Carpalx layouts soon to appear in freedesktop (package xkeyboard-config) and kbd. Thanks to Perry Thompson.">2016/04/18 &mdash; Perry Thompson 氏のおかげで、Carpalx の配列が freedesktop (xkeyboard-config パッケージ) と kbd に含まれるようになります。
<p title="9/sep/14 &mdash; A new layout&mdash;De Correspondent&mdash;for the Dutch language in collaboration with De Correspondent.">2014/09/09 &mdash; <a href="https://decorrespondent.nl/en">De Correspondent 社</a>と共同で、オランダ語用の新しい配列 <a href="de_correspondent.html">De Correspondent</a> を作りました。
<p title="16/may/14 &mdash; Added evaluation of the Norman layout. This layout modifies 14/26 keys and has statistics similar to Colemak. Detailed statistics are available.">2014/05/16 &mdash; <a href="http://www.normanlayout.info">Norman 配列</a>の<a href="full_optimization.html">評価値</a>を追加しました。この配列は 26 キー中の 14 キーを入れ替えて Colemak 同等の統計的性能を持ちます。<a href="keyboard_layouts.html">詳細な統計データ</a>もあります。
<p title="12/feb/14 &mdash; Added evaluationof the abKey layout. Its alphabetic layout makes no attempt at ergonomics. Detailed statistics are available.">2014/02/12 &mdash; <a href="http://www.cnet.com.au/from-qwerty-to-abkey-240003768.htm">abKey 配列</a>の<a href="popular_alternatives.html">評価値</a>を追加しました。ただしエルゴノミクス的側面の評価を試みてはいません。<a href="keyboard_layouts.html">詳細な統計データ</a>もあります。
</div>


<h1>
Carpalx man page
</h1>




<div id="manpage">

<body style="background-color: white"><div name="index"><p><a name="__index__"></a><ul><li><a href="man_page.html#name">NAME</a><li><a href="man_page.html#synopsis">SYNOPSIS</a><li><a href="man_page.html#description">DESCRIPTION</a><li><a href="man_page.html#configuration">CONFIGURATION</a><ul><li><a href="man_page.html#configuration_file_name_and_path">Configuration file name and path</a><li><a href="man_page.html#configuration_structure">Configuration structure</a></ul><li><a href="man_page.html#history">HISTORY</a><li><a href="man_page.html#bugs">BUGS</a><li><a href="man_page.html#author">AUTHOR</a><li><a href="man_page.html#contact">CONTACT</a><li><a href="man_page.html#internal_functions">INTERNAL FUNCTIONS</a><ul><li><a href="man_page.html#optimize_keyboard__"><code>optimize_keyboard()</code></a><li><a href="man_page.html#_swap_keys__"><code>_swap_keys()</code></a><li><a href="man_page.html#_swap_key_pair__"><code>_swap_key_pair()</code></a><li><a href="man_page.html#calculate_effort__"><code>calculate_effort()</code></a><li><a href="man_page.html#read_document__"><code>read_document()</code></a><li><a href="man_page.html#_parse_keyboard_layout">_parse_keyboard_layout</a><li><a href="man_page.html#make_relocatable_list__"><code>make_relocatable_list()</code></a><li><a href="man_page.html#create_keyboard__"><code>create_keyboard()</code></a></ul></ul><hr name="index" /></div><p><hr /><h1><a name="name">NAME</a></h1><p>carpalx - given text input, determine optimal keyboard mapping to minimize typing effort based on a typing effort model<p><hr /><h1><a name="synopsis">SYNOPSIS</a></h1><pre>
  # all configuration read from etc/carpalx.conf
  carpalx -keyboard_input keyboard.conf -keyboard_output keyboard-optimized.conf
          -corpus corpus/words.txt
          -action loadkeyboard,loadtriads,optimize
          -conf etc/carpalx.conf
          [-debug]</pre><p><hr /><h1><a name="description">DESCRIPTION</a></h1><p>carpalx is a keyboard layout optimizer. Given a training corpus (e.g. English text) and parameters that describe typing effort, carpalx uses simulated annealing to find a keyboard layout to minimize typing effort.<p>Typing effort is modeled using three contributions. First, base effort is derived from finger travel distance. Second, row, hand and finger penalties are added to limit use of weaker fingers/hands and distinguish harder-to-reach keys. Third, stroke path effort is used to rate the effort based on finger, row and hand alternation (e.g. asd is much easier to type than sad).<p><hr /><h1><a name="configuration">CONFIGURATION</a></h1><h2><a name="configuration_file_name_and_path">Configuration file name and path</a></h2><p>carpalx will look in the following locations for a configuration file<pre>
  .
  SCRIPT_BIN/../etc
  SCRIPT_BIN/etc
  SCRIPT_BIN/
  ~/.carpalx/etc
  ~/.carpalx</pre><p>where SCRIPT_BIN is the location of the carpalx script. If the name of the configuration file is not passed via -conf, then SCRIPT_NAME.conf is tried where SCRIPT_NAME is the name of the script. For example,<pre>
  &gt; cd carpalx-0.11
  &gt; bin/carpalx</pre><p>will attempt to find carpalx.conf in the above paths.<p>Using -debug -debug will dump the configuration parameters.<pre>
  &gt; bin/carpalx -debug -debug</pre><h2><a name="configuration_structure">Configuration structure</a></h2><p>The configuration file comprises variable-value pairs, which may be placed in blocks.<pre>
  a = 1
  &lt;someblock&gt;
    b = 2
    &lt;anotherblock&gt;
    c = 3
    &lt;/anotherblock&gt;
  &lt;/someblock&gt;</pre><p>Combinations of related parameters (e.g. base effort, keyboard configuration) are stored in individual files (e.g. etc/mask/letters.conf) which are subsequently imported into the main configuration file using &lt;&lt;include&gt;&gt;<pre>
  ...
  &lt;&lt;include etc/mask/letters.conf&gt;&gt;
  ...</pre><p><hr /><h1><a name="history">HISTORY</a></h1><ul><li><strong><a class="item" name="0_10">0.10</a></strong><p>Packaged and versioned code.<li><strong><a class="item" name="0_11">0.11</a></strong><p>Adjusted typing model to include weights for base, effort and stroke components.<p>Improved clarity of effort reports.<p>Improved consistency in configuration file.<p>Added fonts/<li><strong><a class="item" name="0_12">0.12</a></strong><p>Can now load a cache file basedon parsed corpus instead of original corpus.</ul><p><hr /><h1><a name="bugs">BUGS</a></h1><p>Report!<p><hr /><h1><a name="author">AUTHOR</a></h1><p>Martin Krzywinski &lt;<a href="mailto:martink@bcgsc.ca">martink@bcgsc.ca</a>&gt; <a href="http://mkweb.bcgsc.ca">http://mkweb.bcgsc.ca</a><p><hr /><h1><a name="contact">CONTACT</a></h1><pre>
  Martin Krzywinski
  Genome Sciences Centre
  100-570 W 7th Ave 
  Vancouver BC V5Z 4S6</pre><p><hr /><h1><a name="internal_functions">INTERNAL FUNCTIONS</a></h1><p>The content below may be out of date<h2><a name="optimize_keyboard__"><code>optimize_keyboard()</code></a></h2><pre>
  $newkeyboard = optimize_keyboard($keytriads,$keyboard);</pre><p>Simulated annealing is used to search for a better keyboard layout. The function uses the list of triads, generated from the input text document, and an initial keyboard layout.<h2><a name="_swap_keys__"><code>_swap_keys()</code></a></h2><pre>
  $newkeyboard = _swap_keys($keyboard,$reloc_list,$n);</pre><p>Swap one or more pairs ($n randomly sampled pairs) of keys on the keyboard. Lower and upper case characters remain on the same key (e.g. no matter where &#39;a&#39; is, A is always shift+a). This applies to both letter and non-letter characters (e.g. 1 and ! are always on the same key).<p>This function returns a new keyboard object with the keys swapped.<h2><a name="_swap_key_pair__"><code>_swap_key_pair()</code></a></h2><pre>
  $key1 = [$row1,$col1];
  $key2 = [$row2,$col2];
  _swap_key_pair($keyboard,@$key1,@$key2);</pre><p>This function modifies $keyboard in place.<h2><a name="calculate_effort__"><code>calculate_effort()</code></a></h2><pre>
  my $effort = calculate_effort($triads,$keyboard);</pre><p>Given a list of triads and the effort matrix, calculate the total carpal effort required to type the document from which the triads were generated. The effort is a non-negative number. The effort is a sum of the efforts for each triad. The total effort is normalized by the number of triads to remove dependency on document size.<pre>
  abcdefg
  abc     -&gt; effort1
   bcd    -&gt; effort2
    cde   -&gt; effort3
      efg -&gt; effort4
  -------    -------
  abcdefg -&gt; total_effort = ( effort1 + effort2 + effort3 + effort4 ) /4</pre><p>Given a triad xyz, the effort is calculated by the following empirical expression<pre>
  effort = e = k1*effort(x) + k2*effort(x)*effort(y) + k3*effort(x)*effort(y)*effort(z) + k4*patheffort(x,y,z)
             = k1*effort(x)*[1 + effort(y)*(k2 + k3*effort(z))] + k4*patheffort(x,y,z)</pre><p>The form of this expression is motivated by the fact that the effort of three keystrokes is dependent on not only the individual identity of the keys but also alternation of hand, finger, row and column within the triad as well as presence of hard-to-type key combinations (e.g. zxc zqz awz ). For example, it is much easier to type &quot;ttt&quot; than &quot;tbt&quot;, since the left forefinger must travel quite a distance in the latter example. Thus the insertion of the &quot;b&quot; character should impact the effort.<p>In the first-order approximation k2=k3=k4=0 and the effort is simply the effort of typing the first key, effort(x). The individual effort of a key is defined in the &lt;effort_row&gt; blocks and is optionally modified by (a) shift penalty - CAPS are penalized and (b) hand penalty (e.g. you favour typing with your left hand). Since triads overlap, the first-order approximation for the entire document is the sum of the individual key efforts, without any long-range correlations.<p>The addition of parameters k2 and k3 is designed to raise the effort of repeated difficult-to-type characters. This is where the notion of a triad comes into play. Notice that if effort(x) is zero, then the whole triad effort is zero.<p>The patheffort(x,y,z) is a penalty which makes less desirable triads in which the keys do not follow a monotonic progression of columns, or triads which do not alternate hands. Once you try to type &#39;edc&#39; on a qwerty keyboard, or &#39;erd&#39; you will understand what I mean. The patheffort is a combination of two factors: hand alternation and column alternation. First, define a hand and column flag for a triad<p>The definition of path effort here is arbitrary. I find that if the hands alternate between each keystroke, typing is easy (e.g. hf=0x). If both hands are used, but don&#39;t alternate then it&#39;s not as easy, particuarly when some of the columns in the triad are the same (e.g. same finger has to hit two keys like in &quot;jeu&quot;). If the same hand has to be used for three strokes then you&#39;re in trouble, particularly when some of the columns repeat. You can redefine the value of the path effort in &lt;path_efforts&gt; block.<h2><a name="read_document__"><code>read_document()</code></a></h2><pre>
 $triads = read_document(); # create hashref to triad frequencies</pre> <pre>
 $triads-&gt;{aab} = frequency of aab;
 $triads-&gt;{abc} = frequency of abc;</pre><p>Read a document from file and create a list of of character triads. Triads are overlapping (more on overlapping below) 3-character combinations. Each triad is stored along with the number of times it appears in the document. All triads are stored, including overlapping triads.<p>For example, if the document line is<pre>
  I am a very lazy dog with big ears.</pre><p>Then the triads will be<pre>
  i am              iam
    am a            ama
     m a v          mav
       a ve         ave
         ver        ver
          ery       ery
           ry l     ryl
            y la    yla
  ...</pre><p>and so on. Notice that spaces in the document are disregarded during construction of the triads.<p>Depending on the parse mode, the input document undergoes some transformation before triads are constructed. Each mode must be defined using a &lt;mode_def&gt; block. Three modes are defined and you can add more.<p>You can control how the triads are read by the &lt;triad&gt; block<pre>
  &lt;triad&gt;
  maxnum = 1000 # limit number of triads
  overlap = yes # if set to yes, a triad potentially begins at each character (triads overlap by maximum of 2 characters)
                # if set to no, triads abut 
  &lt;/triad&gt;
 
=over</pre><dl><dt><strong><a class="item" name="mode_perl">mode = perl</a></strong><dd><p>If the mode is set to &quot;perl&quot;, then all comment lines are disregarded. Comments are identified by lines that begin with #.<dt><strong><a class="item" name="mode_english">mode = english</a></strong><dd><p>English mode removes all non-alphanumeric characters before constructing triads.<dt><strong><a class="item" name="mode_letter">mode = letter</a></strong><dd><p>All non-letter characters are removed and remaining letters are switched to lower case.</dl><h2><a name="_parse_keyboard_layout">_parse_keyboard_layout</a></h2><p>Parse the &lt;keyboard&gt;&lt;row&gt; blocks to determine the location of keys on the keyboard.<p>Keyboard structure is stored as a hashref. Each key is stored by row/col position<pre>
  $keyboard-&gt;{key}[ROW][COL]{lc}     = lower case at ROW,COL
  $keyboard-&gt;{key}[ROW][COL]{uc}     = upper case at ROW,COL
  $keyboard-&gt;{key}[ROW][COL]{finger} = finger for hitting key at ROW,COL</pre> <pre>
  $keyboard-&gt;{map}{CHAR}{row}    = ROW for key CHAR
  $keyboard-&gt;{map}{CHAR}{col}    = COL for key CHAR
  $keyboard-&gt;{map}{CHAR}{case}   = CASE of key CHAR
  $keyboard-&gt;{map}{CHAR}{finger} = FINGER for hitting key CHAR</pre><h2><a name="make_relocatable_list__"><code>make_relocatable_list()</code></a></h2><pre>
  my $list = make_relocatable_list($mask)</pre><p>Based on the key mask generated by <code>_parse_mask()</code>, this function returns a list of all keys that can be relocated. The list is a set of row,col pairs.<pre>
  $list = [ ... [row,col], [row,col], ... ]</pre><h2><a name="create_keyboard__"><code>create_keyboard()</code></a></h2><pre>
  my $keyboard = create_keyboard();</pre><p>Parses the keyboard layout and creates an array that keeps track of the keys, their positions, character assignments and typing effort. The keyboard array is indexed by row and column of the key and contains a hash<pre>
  $keyboard-&gt;{key}[row][col]
                           {lc}
                           {uc}
                           {row}
                           {col}
                           {effort}</pre><p>The keyboard layout is read from the &lt;keyboard&gt;&lt;row&gt; blocks. The effort in the {key} part of the keyboard object is the canonical effort for the row,col combination as defined in &lt;effort_row&gt; plus any baseline and hand penalties.<p>The keymap hash is a direct mapping between a character and its position and hand assignment on the keyboard<pre>
  $keyboard-&gt;{map}{CHAR}
                       {row}
                       {col}
                       {hand}
                       {effort}</pre><p>The effort in the {map} part of the keyboard object is the effort for the character, based on its row,col combination and includes the shift penalty.<p>For the standard qwerty layout, look at the keyboard you&#39;re using right now (true for &gt;99% of typists). For Dvorak layout, see <a href="http://www.mwbrooks.com/dvorak.">http://www.mwbrooks.com/dvorak.</a></body>

</div>




<br clear=both>
</div>



<div id="copyright">
Carpalx | keyboard layout optimizer | <a href="http://mkweb.bcgsc.ca/carpalx">ホーム</a> | &copy; 2005-2014 <a href="mailto:martink@bcgsc.ca">Martin Krzywinski</a> | <a href="http://mkweb.bcgsc.ca">他のプロジェクト</a>
</div>

</div>

</div>

<!-- script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script -->
<!-- script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-10760878-1");
pageTracker._trackPageview();
} catch(err) {}</script -->
<a href="https://github.com/stak/carpalx-ja"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>

</body>
</html>


